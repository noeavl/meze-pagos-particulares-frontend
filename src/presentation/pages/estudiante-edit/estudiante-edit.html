<div class="p-6 max-w-4xl mx-auto">
  <div class="mb-6">
    <div class="flex items-center gap-2 text-sm text-gray-600 mb-4">
      <a [routerLink]="['/estudiantes']" class="text-blue-600 hover:underline"
        >Estudiantes</a
      >
      <i class="pi pi-chevron-right text-xs"></i>
      <span>Editar Estudiante</span>
    </div>
    <h1 class="text-2xl font-bold text-gray-800">
      {{ loadingData ? "Cargando..." : "Editar Estudiante" }}
    </h1>
  </div>

  @if (errorMessage) {
  <div
    class="mb-6 p-4 bg-red-100 text-red-700 rounded-lg border border-red-200"
  >
    <div class="flex items-center">
      <i class="pi pi-exclamation-triangle mr-2"></i>
      {{ errorMessage }}
    </div>
  </div>
  } @if (loadingData) {
  <div class="flex justify-center items-center py-12">
    <div
      class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"
    ></div>
  </div>
  } @else {
  <form [formGroup]="estudianteForm" (ngSubmit)="onSubmit()">
    <p-card>
      <ng-template #header>
        <div class="flex items-center gap-2 p-4">
          <i class="pi pi-user text-blue-600"></i>
          <h2 class="text-lg font-semibold text-gray-800">
            Informaci√≥n del Estudiante
          </h2>
        </div>
      </ng-template>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- Nombres -->
        <div class="flex flex-col gap-2">
          <label for="nombres" class="text-sm font-medium text-gray-700">
            Nombres <span class="text-red-500">*</span>
          </label>
          <input
            pInputText
            id="nombres"
            formControlName="nombres"
            placeholder="Ingrese los nombres"
            [invalid]="isInvalid('nombres')"
            class="w-full"
          />
          @if (isInvalid('nombres')) {
          <small class="p-error">
            {{ getErrorMessage("nombres") }}
          </small>
          }
        </div>

        <!-- Apellido Paterno -->
        <div class="flex flex-col gap-2">
          <label
            for="apellidoPaterno"
            class="text-sm font-medium text-gray-700"
          >
            Apellido Paterno <span class="text-red-500">*</span>
          </label>
          <input
            pInputText
            id="apellidoPaterno"
            formControlName="apellidoPaterno"
            placeholder="Ingrese apellido paterno"
            [invalid]="isInvalid('apellidoPaterno')"
            class="w-full"
          />
          @if (isInvalid('apellidoPaterno')) {
          <small class="p-error">
            {{ getErrorMessage("apellidoPaterno") }}
          </small>
          }
        </div>

        <!-- Apellido Materno -->
        <div class="flex flex-col gap-2">
          <label
            for="apellidoMaterno"
            class="text-sm font-medium text-gray-700"
          >
            Apellido Materno <span class="text-red-500">*</span>
          </label>
          <input
            pInputText
            id="apellidoMaterno"
            formControlName="apellidoMaterno"
            placeholder="Ingrese apellido materno"
            [invalid]="isInvalid('apellidoMaterno')"
            class="w-full"
          />
          @if (isInvalid('apellidoMaterno')) {
          <small class="p-error">
            {{ getErrorMessage("apellidoMaterno") }}
          </small>
          }
        </div>

        <!-- Nivel -->
        <div class="flex flex-col gap-2">
          <label for="nivel" class="text-sm font-medium text-gray-700">
            Nivel <span class="text-red-500">*</span>
          </label>
          <select
            id="nivel"
            formControlName="nivel"
            class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-500]="isInvalid('nivel')"
          >
            <option value="">Seleccione nivel</option>
            @for (item of nivelesOptions; track $index) {
            <option [value]="item.value">
              {{ item.label }}
            </option>
            }
          </select>
          @if (isInvalid('nivel')) {
          <small class="p-error">
            {{ getErrorMessage("nivel") }}
          </small>
          }
        </div>

        <!-- Grado -->
        <div class="flex flex-col gap-2">
          <label for="grado" class="text-sm font-medium text-gray-700">
            Grado <span class="text-red-500">*</span>
          </label>
          <select
            id="grado"
            formControlName="grado"
            class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-500]="isInvalid('grado')"
          >
            <option value="">Seleccione grado</option>
            @for (item of gradosOptions; track $index) {
            <option [value]="item.value">
              {{ item.label }}
            </option>
            }
          </select>
          @if (isInvalid('grado')) {
          <small class="p-error">
            {{ getErrorMessage("grado") }}
          </small>
          }
        </div>

        <!-- Modalidad -->
        <div class="flex flex-col gap-2">
          <label for="modalidad" class="text-sm font-medium text-gray-700">
            Modalidad <span class="text-red-500">*</span>
          </label>
          <select
            id="modalidad"
            formControlName="modalidad"
            class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            [class.border-red-500]="isInvalid('modalidad')"
          >
            <option value="">Seleccione modalidad</option>
            @for (item of modalidadOptions; track $index) {
            <option [value]="item.value">
              {{ item.label }}
            </option>
            }
          </select>
          @if(isInvalid('modalidad')){
          <small class="p-error">
            {{ getErrorMessage("modalidad") }}
          </small>
          }
        </div>
      </div>

      <ng-template #footer>
        <div class="flex justify-end gap-3 p-4">
          <button
            pButton
            type="button"
            label="Cancelar"
            severity="secondary"
            (click)="onCancel()"
            [disabled]="loading"
          ></button>
          <button
            pButton
            type="submit"
            [disabled]="loading || estudianteForm.invalid"
            class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            {{ loading ? "Actualizando..." : "Actualizar Estudiante" }}
          </button>
        </div>
      </ng-template>
    </p-card>
  </form>
  }
</div>
