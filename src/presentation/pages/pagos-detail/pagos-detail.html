<div class="max-w-6xl mx-auto p-6 bg-gray-50 min-h-screen">
  <!-- Header -->
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
    <div class="flex justify-between items-center">
      <div>
        <h1 class="text-2xl font-bold text-gray-900">Detalle del Adeudo</h1>
        <p class="text-gray-600 text-sm mt-1">Información completa y historial de pagos</p>
      </div>
      <div class="flex gap-2">
        <button
          [routerLink]="['/pagos/create', adeudoId]"
          pButton
          type="button"
          label="Registrar Pago"
          icon="fas fa-credit-card"
          [disabled]="!adeudo || adeudo.estado.displayValue === 'Pagado'"
        ></button>
        <button
          [routerLink]="['/adeudos']"
          pButton
          type="button"
          label="Volver"
          icon="fas fa-arrow-left"
          class="p-button-outlined p-button-secondary"
        ></button>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  @if (error) {
  <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6">
    <div class="flex items-center">
      <i class="fas fa-exclamation-triangle mr-2"></i>
      {{ error }}
    </div>
  </div>
  }

  <!-- Loading -->
  @if (loading) {
  <div class="flex justify-center items-center py-12">
    <p-progressSpinner strokeWidth="3" animationDuration="1s"></p-progressSpinner>
  </div>
  }

  <!-- Adeudo Information -->
  @if (adeudo && !loading) {
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
    
    <!-- Adeudo Summary Card -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
      <div class="text-center mb-6">
        <div class="flex justify-center items-center gap-3 mb-2">
          <h2 class="text-2xl font-bold text-gray-900">Adeudo #{{ adeudo.id }}</h2>
          <span 
            class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium"
            [ngClass]="adeudo.estado.colorClass"
          >
            {{ adeudo.estado.displayValue }}
          </span>
        </div>
        <p class="text-lg text-gray-600">{{ adeudo.concepto.nombre }}</p>
      </div>
      
      <!-- Amount Summary -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="text-center p-4 bg-blue-50 rounded-lg">
          <p class="text-sm font-medium text-blue-600 mb-1">Monto Total</p>
          <p class="text-2xl font-bold text-blue-700">${{ adeudo.montoTotal | number:'1.2-2' }}</p>
        </div>
        <div class="text-center p-4 bg-green-50 rounded-lg">
          <p class="text-sm font-medium text-green-600 mb-1">Pagado</p>
          <p class="text-2xl font-bold text-green-700">${{ adeudo.montoPagado | number:'1.2-2' }}</p>
        </div>
        <div class="text-center p-4 bg-orange-50 rounded-lg">
          <p class="text-sm font-medium text-orange-600 mb-1">Pendiente</p>
          <p class="text-2xl font-bold text-orange-700">${{ adeudo.montoPendiente | number:'1.2-2' }}</p>
        </div>
      </div>
    </div>

    <!-- Details Grid -->
    <div class="grid lg:grid-cols-2 gap-6 mb-6">
      
      <!-- Student Information -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4 pb-2 border-b border-gray-200">
          Estudiante
        </h3>
        <div class="space-y-3">
          <div class="flex justify-between">
            <span class="text-gray-600 text-sm">Nombre:</span>
            <span class="font-medium text-gray-900">
              {{ adeudo.estudiante.nombres }} {{ adeudo.estudiante.apellidoPaterno }} {{ adeudo.estudiante.apellidoMaterno }}
            </span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 text-sm">Nivel:</span>
            <span class="text-gray-900">{{ adeudo.estudiante.nivel.displayValue }}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 text-sm">Grado:</span>
            <span class="text-gray-900">{{ adeudo.estudiante.grado }}°</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 text-sm">Modalidad:</span>
            <span class="text-gray-900">{{ adeudo.estudiante.modalidad.displayValue }}</span>
          </div>
        </div>
      </div>

      <!-- Concept Information -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4 pb-2 border-b border-gray-200">
          Concepto de Pago
        </h3>
        <div class="space-y-3">
          <div class="flex justify-between">
            <span class="text-gray-600 text-sm">Concepto:</span>
            <span class="font-medium text-gray-900">{{ adeudo.concepto.nombre }}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 text-sm">Período:</span>
            <span class="text-gray-900">{{ adeudo.concepto.periodo.displayValue }}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 text-sm">Fecha Inicio:</span>
            <span class="text-gray-900">{{ adeudo.fechaInicio | date:'dd/MM/yyyy' }}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 text-sm">Fecha Vencimiento:</span>
            <span class="text-gray-900">{{ adeudo.fechaVencimiento | date:'dd/MM/yyyy' }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Payment History -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4 pb-2 border-b border-gray-200">
        Historial de Pagos
      </h3>
      
      <p-table 
        [value]="pagos"
        [paginator]="true"
        [rows]="5"
        [showCurrentPageReport]="true"
        currentPageReportTemplate="Mostrando {first} - {last} de {totalRecords} pagos"
      >
        <ng-template pTemplate="header">
          <tr>
            <th class="text-left">Folio</th>
            <th class="text-left">Fecha</th>
            <th class="text-left">Método</th>
            <th class="text-right">Monto</th>
          </tr>
        </ng-template>
        
        <ng-template pTemplate="body" let-pago>
          <tr class="hover:bg-gray-50">
            <td class="font-medium">{{ pago.folio }}</td>
            <td>{{ pago.fecha | date:'dd/MM/yyyy' }}</td>
            <td>{{ pago.metodoPago }}</td>
            <td class="text-right font-semibold text-green-600">
              ${{ pago.monto | number:'1.2-2' }}
            </td>
          </tr>
        </ng-template>
        
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="4" class="text-center py-8">
              <div class="flex flex-col items-center">
                <i class="fas fa-receipt text-4xl text-gray-300 mb-4"></i>
                <h4 class="text-lg font-medium text-gray-900 mb-2">Sin pagos registrados</h4>
                <p class="text-gray-600 mb-4">Este adeudo aún no tiene pagos registrados</p>
                <button
                  [routerLink]="['/pagos/create', adeudoId]"
                  pButton
                  type="button"
                  label="Registrar primer pago"
                  icon="fas fa-plus"
                  class="p-button-outlined"
                  [disabled]="adeudo.estado.displayValue === 'Pagado'"
                ></button>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
  }

  <!-- Not Found Message -->
  @if (!adeudo && !loading && !error) {
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-12">
    <div class="text-center">
      <i class="fas fa-search text-4xl text-gray-300 mb-4"></i>
      <h3 class="text-lg font-medium text-gray-900 mb-2">Adeudo no encontrado</h3>
      <p class="text-gray-600 mb-6">No se pudo encontrar la información del adeudo solicitado</p>
      <button
        [routerLink]="['/adeudos']"
        pButton
        type="button"
        label="Volver a la lista"
        icon="fas fa-arrow-left"
        class="p-button-outlined p-button-secondary"
      ></button>
    </div>
  </div>
  }
</div>
